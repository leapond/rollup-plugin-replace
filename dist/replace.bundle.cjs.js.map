{"version":3,"file":"replace.bundle.cjs.js","sources":["../src/index.js"],"sourcesContent":["import {createFilter} from '@rollup/pluginutils';\n\nconst optionsDefault = {\n      include: '**/*.(js|ts|css|html|vue|car)',\n      LEAPOND: false\n    },\n    warn = console.warn.bind(console, '[LEAPOND:replace]:')\n/**\n * @param options\n * @return {*|boolean|null|{code, map: {mappings: string}}|{transform(*, *=): (null|{code: *, map: {mappings: string}}), name: string}}\n */\nexport default function leapondReplace(options) {\n  if (!options) {\n    console.warn('missed options')\n    return\n  }\n\n  if (arguments.length === 2) {\n    options = {rules: [[options, arguments[1]]]}\n  } else if (Array.isArray(options)) {\n    if (Array.isArray(options[0])) options = {rules: options}; else options = {rules: [options]}\n  }\n\n  if (options.LEAPOND) {\n    if (!Array.isArray(options.rules)) options.rules = []\n    options.rules.unshift([/(\\/\\*+\\s*<DEV\\s*)\\*+\\/[\\s\\S]*?\\/\\*+(\\s*DEV>\\s*\\*+\\/)/mg, ''])\n  }\n\n  if (!Array.isArray(options.rules) || !options.rules.length) return warn('rules missed') || false\n\n  const filteredRules = []\n  options.rules.forEach(r => {\n    if (!Array.isArray(r) || r.length < 2) return warn('wrong rule 0:', r)\n    let finder = r[0]\n    if (!finder || ((typeof finder !== 'string' && Object.prototype.toString.call(finder) !== '[object RegExp]'))) return warn('wrong rule 1:', r)\n    if (typeof finder === 'string') r[0] = new RegExp(finder, 'mg'); else if (Object.prototype.toString.call(finder) !== '[object RegExp]') return warn('wrong rule 2:', r)\n    filteredRules.push(r)\n  })\n\n  if (!filteredRules.length) return warn('rules missed 3') || false\n\n  options.rules = filteredRules\n\n  options = Object.assign({}, optionsDefault, options)\n\n  const filter = createFilter(options.include, options.exclude);\n\n  return {\n    name: 'leapond-replace',\n    transform(code, id) {\n      if (!filter(id)) return null;\n      options.rules.forEach(r => code = code.replace(r[0], r[1]))\n\n      return {\n        code,\n        map: this.getCombinedSourcemap()\n      };\n    }\n  };\n}"],"names":["const","let","createFilter"],"mappings":";;;;AAEAA,IAAM,cAAc,GAAG;AACvB,MAAM,OAAO,EAAE,+BAA+B;AAC9C,MAAM,OAAO,EAAE,KAAK;AACpB,KAAK;AACL,IAAI,IAAI,GAAG,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,EAAE,oBAAoB,EAAC;AAC3D;AACA;AACA;AACA;AACe,SAAS,cAAc,CAAC,OAAO,EAAE;AAChD,EAAE,IAAI,CAAC,OAAO,EAAE;AAChB,IAAI,OAAO,CAAC,IAAI,CAAC,gBAAgB,EAAC;AAClC,IAAI,MAAM;AACV,GAAG;AACH;AACA,EAAE,IAAI,SAAS,CAAC,MAAM,KAAK,CAAC,EAAE;AAC9B,IAAI,OAAO,GAAG,CAAC,KAAK,EAAE,CAAC,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC,CAAC,CAAC,CAAC,EAAC;AAChD,GAAG,MAAM,IAAI,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;AACrC,IAAI,IAAI,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,IAAE,OAAO,GAAG,CAAC,KAAK,EAAE,OAAO,CAAC,GAAC,QAAM,OAAO,GAAG,CAAC,KAAK,EAAE,CAAC,OAAO,CAAC,IAAC;AAChG,GAAG;AACH;AACA,EAAE,IAAI,OAAO,CAAC,OAAO,EAAE;AACvB,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,IAAE,OAAO,CAAC,KAAK,GAAG,KAAE;AACzD,IAAI,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,wDAAwD,EAAE,EAAE,CAAC,EAAC;AACzF,GAAG;AACH;AACA,EAAE,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,IAAE,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,OAAK;AAClG;AACA,EAAEA,IAAM,aAAa,GAAG,GAAE;AAC1B,EAAE,OAAO,CAAC,KAAK,CAAC,OAAO,WAAC,GAAK;AAC7B,IAAI,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,MAAM,GAAG,CAAC,IAAE,OAAO,IAAI,CAAC,eAAe,EAAE,CAAC,GAAC;AAC1E,IAAIC,IAAI,MAAM,GAAG,CAAC,CAAC,CAAC,EAAC;AACrB,IAAI,IAAI,CAAC,MAAM,MAAM,OAAO,MAAM,KAAK,QAAQ,IAAI,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,iBAAiB,EAAE,IAAE,OAAO,IAAI,CAAC,eAAe,EAAE,CAAC,GAAC;AAClJ,IAAI,IAAI,OAAO,MAAM,KAAK,QAAQ,IAAE,CAAC,CAAC,CAAC,CAAC,GAAG,IAAI,MAAM,CAAC,MAAM,EAAE,IAAI,CAAC,GAAC,MAAM,IAAI,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,iBAAiB,IAAE,OAAO,IAAI,CAAC,eAAe,EAAE,CAAC,GAAC;AAC3K,IAAI,aAAa,CAAC,IAAI,CAAC,CAAC,EAAC;AACzB,GAAG,EAAC;AACJ;AACA,EAAE,IAAI,CAAC,aAAa,CAAC,MAAM,IAAE,OAAO,IAAI,CAAC,gBAAgB,CAAC,IAAI,OAAK;AACnE;AACA,EAAE,OAAO,CAAC,KAAK,GAAG,cAAa;AAC/B;AACA,EAAE,OAAO,GAAG,MAAM,CAAC,MAAM,CAAC,EAAE,EAAE,cAAc,EAAE,OAAO,EAAC;AACtD;AACA,EAAED,IAAM,MAAM,GAAGE,wBAAY,CAAC,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,OAAO,CAAC,CAAC;AAChE;AACA,EAAE,OAAO;AACT,IAAI,IAAI,EAAE,iBAAiB;AAC3B,IAAI,6BAAS,CAAC,IAAI,EAAE,EAAE,EAAE;AACxB,MAAM,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,IAAE,OAAO,IAAI,GAAC;AACnC,MAAM,OAAO,CAAC,KAAK,CAAC,OAAO,WAAC,YAAK,IAAI,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,IAAC,EAAC;AACjE;AACA,MAAM,OAAO;AACb,cAAQ,IAAI;AACZ,QAAQ,GAAG,EAAE,IAAI,CAAC,oBAAoB,EAAE;AACxC,OAAO,CAAC;AACR,KAAK;AACL,GAAG,CAAC;AACJ;;;;"}